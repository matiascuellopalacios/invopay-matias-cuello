
<div class="sales-list">
  <div class="sales-list__card">
    <!-- Title Section -->
    <div class="sales-list__title-section">
      <h1 class="sales-list__title">{{ 'IP.SELLS_LIST.TITLE' | translate }}</h1>
      <button type="button" class="sales-list__mobile-filter-btn" (click)="openMobileFilters()">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
          <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
        </svg>
        Filtrar
      </button>
    </div>

    <!-- Filters Section -->
    <div class="sales-list__filters">
      <div class="sales-list__filters-header">
        <svg xmlns="http://www.w3.org/2000/svg" width="15" height="10" class="sales-list__filter-icon" viewBox="0 0 16 16">
          <path d="M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5zm1 .5v1.308l4.372 4.858A.5.5 0 0 1 7 8.5v5.306l2-.666V8.5a.5.5 0 0 1 .128-.334L13.5 3.308V2z" fill="#0071CE"/>
        </svg>
        <h2 class="sales-list__filters-subtitle">{{ 'IP.SELLS_LIST.FILTERS.TITLE' | translate }}</h2>
      </div>
      
      <div class="sales-list__filters-container">
       <div class="sales-list__filter-group">
  <label for="fecha-desde" class="sales-list__filter-label">{{ 'IP.SELLS_LIST.FILTERS.DATE_FROM' | translate }}</label>
  <input 
    type="date" 
    id="fecha-desde" 
    class="sales-list__filter-input" 
    [(ngModel)]="dateFrom"
    [max]="maxDate"
    (change)="onDateFromChange($event)"
    [placeholder]="'IP.SELLS_LIST.FILTERS.SELECT_DATE' | translate"/>
</div>

<div class="sales-list__filter-group">
  <label for="fecha-hasta" class="sales-list__filter-label">{{ 'IP.SELLS_LIST.FILTERS.DATE_TO' | translate }}</label>
  <input 
    type="date" 
    id="fecha-hasta" 
    class="sales-list__filter-input" 
    [(ngModel)]="dateTo"
    [min]="minDateTo"
    [max]="maxDate"
    (change)="onDateToChange($event)"
    [placeholder]="'IP.SELLS_LIST.FILTERS.SELECT_DATE' | translate"/>
</div>
        
        <div class="sales-list__filter-actions">
          <button class="btn btn--search" (click)="onSearch()" [disabled]="isSearchDisabled" [class.btn--disabled]="isSearchDisabled">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path [attr.stroke]="isSearchDisabled ? '#CBD5E0' : 'white'" d="M7 13A6 6 0 1 0 7 1a6 6 0 0 0 0 12zM15 15l-4-4" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </button>
          <button class="btn btn--search" (click)="openFilters()">
            <img src="../../../assets/icons/filter3.svg" alt="Filtro" class="sales-list__filters-icon">
          </button>
        </div>
      </div>
    </div>

    <!-- Table Container - Desktop -->
    <div class="sales-list__table-container sales-list__table-container--desktop">
      <div class="sales-list__body">
        <div>
          <app-table
            *ngIf="titlesFile && titlesFile.size > 0 && paginatedData && paginatedData.length > 0"
            [data]="paginatedData"
            [initTable]="false"
            [propertyOrder]="columns"
            [titlesFile]="titlesFile"
            [actions]="actions"
            keyTranslate = 'IP.ADMIN_TABLE'
            [scroll]="true"
            [tableStyle]="tableStyle"
            (action)="onTableAction($event)"
            (sort)="onTableSort($event)">
            
          </app-table>
          
          <app-no-data 
            *ngIf="titlesFile && titlesFile.size > 0 && (!paginatedData || paginatedData.length === 0)">
          </app-no-data>
        </div>
      </div>
    </div>

    <!-- Cards Container - Mobile -->
    <div class="sales-list__cards-container sales-list__cards-container--mobile">
      <app-mobile-card-list
        [data]="paginatedData"
        [config]="mobileCardConfig"
        [showNoData]="!paginatedData || paginatedData.length === 0"
        (cardAction)="onMobileCardAction($event)">
        <app-no-data no-data></app-no-data>
      </app-mobile-card-list>
    </div>

    <!-- Paginator Section -->
    <div class="sales-list__paginator-container" *ngIf="paginatedData && paginatedData.length > 0">
      <div class="sales-list__rows-per-page">
        <span>Filas por páginas:</span>
        <select class="sales-list__rows-select" [(ngModel)]="itemsPerPage" (ngModelChange)="onItemsPerPageChange($event)">
          <option [value]="10">10</option>
          <option [value]="25">25</option>
          <option [value]="50">50</option>
          <option [value]="100">100</option>
        </select>
      </div>
      
       <app-paginator 
    *ngIf="showPaginator"
    class="sales-list__paginator"
    [totalItems]="totalItems"
    [itemsPerPage]="itemsPerPage"
    [currentPages]="currentPages"
    (pageChange)="onPageChange($event)">
  </app-paginator>
    </div>
  </div>
</div>

<!-- Modal de filtros adicionales (Producto/Broker) -->
<app-additional-filters-modal
  [open]="showFiltersModal"
  [title]="'IP.SELLS_LIST.MODAL.TITTLE' | translate"
  [clearLabel]="'IP.SELLS_LIST.MODAL.CLEAR' | translate"
  [cancelLabel]="'IP.SELLS_LIST.MODAL.CANCEL' | translate"
  [applyLabel]="'IP.SELLS_LIST.MODAL.APPLY' | translate"
  (openChange)="showFiltersModal = $event"
  (clear)="onClearFilters()"
  (cancel)="closeFilters()"
  (apply)="applyModalFilters()">
  
  <div class="filters-row-modal">
    <div class="filter-group-modal filter-group-modal--floating">
      <label for="producto-modal" class="filter-label-modal--floating">{{ 'IP.SELLS_LIST.FILTERS.PRODUCT' | translate }}</label>
      <select id="producto-modal" class="filter-select-modal--floating" [(ngModel)]="selectedProduct">
        <option value="">{{ 'IP.SELLS_LIST.FILTERS.PRODUCTS_PLACEHOLDER' | translate }}</option>
        <option value="Seguro de Vida Total">{{ 'IP.SELLS_LIST.PRODUCTS.HEALTH_INSURANCE' | translate }}</option>
        <option value="Seguro de Hogar Premium">{{ 'IP.SELLS_LIST.PRODUCTS.HOME_INSURANCE' | translate }}</option>
        <option value="Seguro Automotor Plus">{{ 'IP.SELLS_LIST.PRODUCTS.AUTO_INSURANCE' | translate }}</option>
        <option value="Seguro de Accidentes Personales">{{ 'IP.SELLS_LIST.PRODUCTS.AUTO_INSURANCE' | translate }}</option>
      </select>
    </div>

    <div class="filter-group-modal filter-group-modal--floating">
      <label for="broker-modal" class="filter-label-modal--floating">{{ 'IP.SELLS_LIST.FILTERS.BROKER' | translate }}</label>
      <select id="broker-modal" class="filter-select-modal--floating" [(ngModel)]="selectedBroker">
        <option value="">{{ 'IP.SELLS_LIST.FILTERS.BROKERS_PLACEHOLDER' | translate }}</option>
        <option value="juan-perez">{{ 'IP.SELLS_LIST.BROKERS.JUAN_PEREZ' | translate }}</option>
        <option value="Sofía Gómez">{{ 'IP.SELLS_LIST.BROKERS.SOFIA_GOMEZ' | translate }}</option>
        <option value="María Rodríguez">{{ 'IP.SELLS_LIST.BROKERS.MARIA_RODRIGUEZ' | translate }}</option>
      </select>
    </div>
  </div>
</app-additional-filters-modal>

<!-- Modal mobile con fechas -->
<app-mobile-date-filters-modal
  [open]="showMobileFiltersModal"
  [title]="'IP.SELLS_LIST.FILTERS.TITLE' | translate"
  (openChange)="showMobileFiltersModal = $event">
  
  <div class="mobile-filters-content">
    <div class="sales-list__filter-group">
      <label for="fecha-desde-mobile" class="sales-list__filter-label">{{ 'IP.SELLS_LIST.FILTERS.DATE_FROM' | translate }}</label>
      <input 
        type="date" 
        id="fecha-desde-mobile"
        class="sales-list__filter-input"
        [(ngModel)]="dateFrom"
        [max]="maxDate"
        (change)="onDateFromChange($event)"/>
    </div>

    <div class="sales-list__filter-group">
      <label for="fecha-hasta-mobile" class="sales-list__filter-label">{{ 'IP.SELLS_LIST.FILTERS.DATE_TO' | translate }}</label>
      <input 
        type="date" 
        id="fecha-hasta-mobile"
        class="sales-list__filter-input"
        [(ngModel)]="dateTo"
        [min]="minDateTo"
        [max]="maxDate"
        (change)="onDateToChange($event)"/>
    </div>
    
    <div class="mobile-filters-content__actions">
      <button class="btn btn--search" (click)="onSearch()" [disabled]="isSearchDisabled">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <path [attr.stroke]="isSearchDisabled ? '#CBD5E0' : 'white'" d="M7 13A6 6 0 1 0 7 1a6 6 0 0 0 0 12zM15 15l-4-4" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
      <button class="btn btn--filter" (click)="openFilters()">
        <img src="../../../assets/icons/filter3.svg" alt="Filtro" class="sales-list__filters-icon">
      </button>
    </div>
  </div>
</app-mobile-date-filters-modal>